(()=>{"use strict";function e(){this.subscribers={}}var t;window.EventEmitter=e,e.prototype.on=function(e,t){this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push(t)},e.prototype.emit=function(e){if(this.subscribers[e]){var t=[].slice.call(arguments,1);this.subscribers[e].forEach((function(e){e.apply(null,t)}))}},window.whiteboard=new window.EventEmitter,[].slice.call(document.querySelectorAll(".marker")).forEach((function(e){e.style.backgroundColor=e.id,e.addEventListener("click",(function(){t=this.id,document.querySelector(".selected").classList.remove("selected"),this.classList.add("selected")}))}));var i=document.getElementById("paint"),n=i.getContext("2d");function o(){n.setTransform(1,0,0,1,0,0);var e=window.devicePixelRatio||1,t=i.clientWidth*e,o=i.clientHeight*e;if(t!==i.width||o!==i.height){var s=n.getImageData(0,0,i.width,i.height);i.width=t,i.height=o,n.putImageData(s,0,0)}n.scale(e,e),n.lineWidth=5,n.lineJoin="round",n.lineCap="round"}o(),window.addEventListener("resize",o);var s={x:0,y:0},r={x:0,y:0},a=!1;i.addEventListener("mousedown",(function(e){a=!0,s.x=e.pageX-this.offsetLeft,s.y=e.pageY-this.offsetTop})),i.addEventListener("mouseup",(function(){a=!1})),i.addEventListener("mousemove",(function(e){a&&(r.x=s.x,r.y=s.y,s.x=e.pageX-this.offsetLeft,s.y=e.pageY-this.offsetTop,whiteboard.draw(r,s,t,!0))})),whiteboard.draw=function(e,t,i,o){n.beginPath(),n.strokeStyle=i||"black",n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.closePath(),n.stroke(),o&&whiteboard.emit("draw",e,t,i)};var d=window.whiteboard,c=window.io(window.location.origin);c.on("connect",(function(){console.log("Connected!")})),c.on("load",(function(e){e.forEach((function(e){var t=e.start,i=e.end,n=e.color;d.draw(t,i,n,!1)}))})),c.on("draw",(function(e,t,i){d.draw(e,t,i,!1)})),d.on("draw",(function(e,t,i){c.emit("draw",e,t,i)}))})();